ORG 1000H
MSJ DB "EL HANDSHAKE LA ROMPE"
FIN DB ?

ORG 3000H
IMPRIMIR: PUSH AX
          MOV AL, [BX]
          OUT DATO, AL
          INC BX
          MOV AL, 20H
          OUT EOI, AL
          POP AX
          IRET

ORG 2000H
MOV AX, IMPRIMIR
MOV BX, 16
MOV [BX], AX

CLI
MOV AL, 11111011B
OUT IMR, AL

MOV AL, 4
OUT INT2, AL
STI

MOV BX, OFFSET MSJ
IN AL, ESTADO
OR AL, 80H
OUT ESTADO, AL

POLL: CMP BX, OFFSET FIN
      JNZ POLL

IN AL, ESTADO
AND AL, 07FH
OUT ESTADO, AL

INT 0
END
